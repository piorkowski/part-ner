{% extends "base.html.twig" %}
{% block content %}

    <section class="module bg-dark-60 contact-page-header" {% if content.background_image %}data-background="{{ content.background_image.url }}"{% endif %}>
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-sm-offset-3">
                    <h2 class="module-title font-alt">{{ content.title }}</h2>
                    {% if content.description %}
                        <div class="module-subtitle font-serif">{{ content.description|striptags }}</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <section class="module">
        <div class="container">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1992.0680922061852!2d17.387331983676134!3d50.31385621842524!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x471194c5ee6481cd%3A0x27fae1d095e3746a!2sPartner%20Sp.%20z%20o.o.!5e0!3m2!1spl!2spl!4v1761772520374!5m2!1spl!2spl" width="100%" height="600px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
    </section>

    <section class="module divider-bot">
        <div class="container">
            <div class="row">
                <div class="col-sm-4">
                    <div class="alt-features-item">
                        <div class="alt-features-icon"><span class="icon-megaphone"></span></div>
                        <h3 class="alt-features-title font-alt">{{ 'contact.where'|trans }}</h3>
                        {% if content.address %}{{ content.address|nl2br }}{% endif %}
                    </div>
                    <div class="alt-features-item">
                        <div class="alt-features-icon"><span class="icon-mobile"></span></div>
                        <h3 class="alt-features-title font-alt">{{ 'contact.phone'|trans }}</h3>
                        {% if content.phone %}<a href="tel:{{ content.phone|replace({' ': '', '-': ''}) }}">{{ content.phone }}</a>{% endif %}
                    </div>
                    <div class="alt-features-item">
                        <div class="alt-features-icon"><span class="icon-mail"></span></div>
                        <h3 class="alt-features-title font-alt">{{ 'contact.email'|trans }}</h3>
                        {% if content.email %}<a href="mailto:{{ content.email }}">{{ content.email }}</a>{% endif %}
                    </div>
                </div>
                <div class="col-sm-8">
                    <form id="contactForm" class="form" role="form" method="post" action="{{ path('contact_form_submit') }}">
                        <div class="form-group">
                            <label class="sr-only" for="name">{{ 'contact.form.name'|trans }}</label>
                            <input class="form-control" type="text" id="name" name="name" placeholder="{{ 'contact.form.name'|trans }}" required="required"/>
                        </div>
                        <div class="form-group">
                            <label class="sr-only" for="email">{{ 'contact.form.email'|trans }}</label>
                            <input class="form-control" type="email" id="email" name="email" placeholder="{{ 'contact.form.email'|trans }}" required="required"/>
                        </div>
                        <div class="form-group">
                            <label class="sr-only" for="phone">{{ 'contact.form.phone'|trans }}</label>
                            <input class="form-control" type="text" id="phone" name="phone" placeholder="{{ 'contact.form.phone'|trans }}"/>
                        </div>
                        <div class="form-group">
                            <label class="sr-only" for="subject">{{ 'contact.form.subject'|trans }}</label>
                            <input class="form-control" type="text" id="subject" name="subject" placeholder="{{ 'contact.form.subject'|trans }}" required="required"/>
                        </div>
                        <div class="form-group">
                            <textarea class="form-control" rows="7" id="message" name="message" placeholder="{{ 'contact.form.message'|trans }}" required="required"></textarea>
                        </div>
                        <div class="form-group">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" name="gdpr" required="required"/> {{ 'contact.form.gdpr'|trans }}
                                </label>
                            </div>
                        </div>
                        <input type="hidden" name="recipient" value="{{ content.form_recipient }}">
                        <input type="hidden" name="locale" value="{{ app.request.locale }}">
                        <div class="text-center">
                            <button class="btn btn-block btn-round btn-d" id="cfsubmit" type="submit">{{ 'contact.form.send'|trans }}</button>
                        </div>
                    </form>
                    <div class="ajax-response font-alt" id="contactFormResponse"></div>
                </div>
            </div>
        </div>
    </section>

    {% block javascripts %}
        {{ parent() }}
        <script>
            $(function(){
                function isEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
                $('#contactForm').on('submit', function(e){
                    e.preventDefault();
                    var $f=$(this), ok=true, $msg=$('#contactFormResponse'), $btn=$('#cfsubmit');
                    $msg.html('');
                    $f.find('[required]').each(function(){
                        var $i=$(this), v=$i.val().trim();
                        if(!v || ($i.attr('type')==='email' && !isEmail(v))){ ok=false; $i.addClass('error'); }
                        else { $i.removeClass('error'); }
                    });
                    if(!ok){ $msg.html('<div class="alert alert-danger">{{ 'contact.form.error_required'|trans }}</div>'); return; }
                    $btn.prop('disabled', true).text('{{ 'contact.form.sending'|trans }}');
                    $.ajax({ type:'POST', url:$f.attr('action'), data:$f.serialize() })
                        .done(function(){ $msg.html('<div class="alert alert-success"><i class="fa fa-check"></i> {{ 'contact.form.success'|trans }}</div>'); $f[0].reset(); })
                        .fail(function(){ $msg.html('<div class="alert alert-danger"><i class="fa fa-times"></i> {{ 'contact.form.error_send'|trans }}</div>'); })
                        .always(function(){ $btn.prop('disabled', false).text('{{ 'contact.form.send'|trans }}'); });
                });
                $('#contactForm [required]').on('input change', function(){ $(this).removeClass('error'); });
                var urlParams=new URLSearchParams(window.location.search); var product=urlParams.get('product');
                if(product){ $('#subject').val('{{ 'contact.form.inquiry_about'|trans }}: ' + product); }
            });
        </script>
    {% endblock %}

    <style>
        .google-map{width:100%;height:400px}
        .google-map iframe{width:100%;height:100%;border:0}
        .form-control.error{border-color:#e74c3c}
        .ajax-response{margin-top:20px}
    </style>

{% endblock %}
