{% extends "base.html.twig" %}
{% block content %}
  <div class="page-title-wrap typo-white">
    <div class="page-title-wrap-inner section-bg-dark-1">
      <div class="container">
        <div class="row">
          <div class="col-md-12 text-center">
            {% include 'partials/_breadcrumbs.html.twig' with {
              parent: content.parent is defined ? content.parent : null,
              title: content.title
            } %}
            <h1 class="page-title">{{ content.title }}</h1>
          </div>
        </div>
      </div>
    </div>
  </div>

  <section class="section-wrap pt-80 pb-40">
    <div class="container">

      {% if content.description %}
        <div class="row mb-50">
          <div class="col-md-8 col-md-offset-2 text-center">
            {% if content.category_image %}
              <img src="{{ content.category_image.thumbnails['400x300'] }}" alt="{{ content.title }}" class="mb-30">
            {% endif %}
            <div class="category-description">{{ content.description|raw }}</div>
          </div>
        </div>
      {% endif %}

      <div class="row mb-30">
        <div class="col-md-12">
          <div class="shop-filter">
            <div class="view-mode">
              <span>{{ 'product.view'|trans }}:</span>
              <a href="#" class="grid active" aria-label="Grid view"><i class="ti-layout-grid2"></i></a>
              <a href="#" class="list" aria-label="List view"><i class="ti-view-list"></i></a>
            </div>
            <div class="filter-by">
              <span>{{ 'product.sort_by'|trans }}:</span>
              <select class="product-sort form-control">
                <option value="default">{{ 'product.sort_default'|trans }}</option>
                <option value="name-asc">{{ 'product.sort_name_asc'|trans }}</option>
                <option value="name-desc">{{ 'product.sort_name_desc'|trans }}</option>
                <option value="date-new">{{ 'product.sort_newest'|trans }}</option>
              </select>
            </div>
            {% if content.products.pages is defined %}
              <div class="products-showing">
                {{ 'product.showing'|trans }} <span>{{ content.products.pages|length }}</span>
                {{ 'product.of'|trans }} <span>{{ content.products.total }}</span>
                {{ 'product.results'|trans }}
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="row products-grid" id="products-grid">
        {% if content.products.pages is defined and content.products.pages is iterable %}
          {% set columns = content.products.presentAs == 'two' ? 6 : (content.products.presentAs == 'three' ? 4 : 3) %}
          {% for product in content.products.pages %}
            <div class="col-md-{{ columns }} col-sm-6 product-item-wrap mb-30">
              {% include 'templates/partials/_product-card.html.twig' with { product: product } %}
            </div>
          {% endfor %}
        {% endif %}
      </div>

      {% if content.products.pages is defined and content.products.pages|length > 0 and content.products.pages|length < content.products.total %}
        {% include 'templates/partials/_paginator.html.twig' with {
          page: content.products.page,
          pageCount: content.products.pageCount
        } %}
      {% endif %}

    </div>
  </section>

  <style>
    .product-img-back{position:absolute;top:0;left:0;opacity:0;transition:opacity .3s}
    .product-item:hover .product-img-back{opacity:1}
    .product-item-actions{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);opacity:0;transition:opacity .3s;z-index:10}
    .product-item:hover .product-item-actions{opacity:1}
    .shop-filter{display:flex;align-items:center;justify-content:space-between;padding:20px;background:#f9f9f9;border-radius:4px;flex-wrap:wrap;gap:15px}
    .shop-filter .view-mode,.shop-filter .filter-by,.shop-filter .products-showing{display:flex;align-items:center;gap:10px}
    .shop-filter .view-mode a{display:inline-block;width:35px;height:35px;line-height:35px;text-align:center;border:1px solid #ddd;border-radius:3px;color:#666;transition:.3s}
    .shop-filter .view-mode a:hover,.shop-filter .view-mode a.active{background:#333;border-color:#333;color:#fff}
    .shop-filter select{height:35px;padding:5px 10px;border:1px solid #ddd;border-radius:3px}
    @media (max-width:768px){.shop-filter{flex-direction:column;align-items:flex-start}}
  </style>

  {% block javascripts %}
    {{ parent() }}
    <script>
      $(function(){
        $('.product-sort').on('change', function(){
          var v = $(this).val();
          var url = new URL(window.location.href);
          url.searchParams.set('sort', v);
          window.location = url.toString();
        });
      });
    </script>
  {% endblock %}
{% endblock %}
