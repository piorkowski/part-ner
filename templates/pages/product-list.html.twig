{% extends "base.html.twig" %}

{% block content %}
    <div class="page-title-wrap typo-white">
        <div class="page-title-wrap-inner section-bg-dark-1">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <ol class="breadcrumb">
                            <li><a href="{{ sulu_content_root_path() }}">{{ 'navigation.home'|trans }}</a></li>
                            {% if content.parent is defined %}
                                <li><a href="{{ sulu_content_path(content.parent.id) }}">{{ content.parent.title }}</a></li>
                            {% endif %}
                            <li class="active">{{ content.title }}</li>
                        </ol>
                        <h1 class="page-title">{{ content.title }}</h1>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="section-wrap pt-80 pb-40">
        <div class="container">

            {# Opis kategorii #}
            {% if content.description %}
                <div class="row mb-50">
                    <div class="col-md-8 col-md-offset-2 text-center">
                        {% if content.category_image %}
                            <img src="{{ content.category_image.thumbnails['400x300'] }}" alt="{{ content.title }}" class="mb-30">
                        {% endif %}
                        <div class="category-description">
                            {{ content.description|raw }}
                        </div>
                    </div>
                </div>
            {% endif %}

            {# Filtrowanie i sortowanie #}
            <div class="row mb-30">
                <div class="col-md-12">
                    <div class="shop-filter">
                        <div class="view-mode">
                            <span>{{ 'product.view'|trans }}:</span>
                            <a href="#" class="grid active"><i class="ti-layout-grid2"></i></a>
                            <a href="#" class="list"><i class="ti-view-list"></i></a>
                        </div>
                        <div class="filter-by">
                            <span>{{ 'product.sort_by'|trans }}:</span>
                            <select class="product-sort form-control">
                                <option value="default">{{ 'product.sort_default'|trans }}</option>
                                <option value="name-asc">{{ 'product.sort_name_asc'|trans }}</option>
                                <option value="name-desc">{{ 'product.sort_name_desc'|trans }}</option>
                                <option value="date-new">{{ 'product.sort_newest'|trans }}</option>
                            </select>
                        </div>
                        {% if content.products.pages is defined %}
                            <div class="products-showing">
                                {{ 'product.showing'|trans }}
                                <span>{{ content.products.pages|length }}</span>
                                {{ 'product.of'|trans }}
                                <span>{{ content.products.total }}</span>
                                {{ 'product.results'|trans }}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            {# Lista produkt√≥w #}
            <div class="row products-grid" id="products-grid">
                {% if content.products.pages is defined and content.products.pages is iterable %}
                    {% set columns = content.products.presentAs == 'two' ? 6 : (content.products.presentAs == 'three' ? 4 : 3) %}
                    {% for product in content.products.pages %}
                        <div class="col-md-{{ columns }} col-sm-6 product-item-wrap mb-30">
                            <div class="product-item">
                                <div class="product-img">
                                    <a href="{{ sulu_content_path(product.id) }}">
                                        {% if product.content.images is defined and product.content.images[0] %}
                                            <img src="{{ product.content.images[0].thumbnails['400x400'] }}" alt="{{ product.content.title }}">
                                            {% if product.content.images[1] is defined %}
                                                <img src="{{ product.content.images[1].thumbnails['400x400'] }}" alt="{{ product.content.title }}" class="product-img-back">
                                            {% endif %}
                                        {% else %}
                                            <img src="{{ asset('build/images/placeholder-product.jpg') }}" alt="{{ product.content.title }}">
                                        {% endif %}
                                    </a>
                                    <div class="product-item-actions">
                                        <a href="{{ sulu_content_path(product.id) }}" class="btn btn-sm btn-dark">
                                            {{ 'product.view_details'|trans }}
                                        </a>
                                    </div>
                                </div>

                                <div class="product-item-details">
                                    {% if product.content.subtitle is defined %}
                                        <span class="product-item-category">{{ product.content.subtitle }}</span>
                                    {% endif %}

                                    <h3 class="product-item-name">
                                        <a href="{{ sulu_content_path(product.id) }}">{{ product.content.title }}</a>
                                    </h3>

                                    {% if product.content.product_code is defined %}
                                        <span class="product-code text-muted">{{ 'product.code'|trans }}: {{ product.content.product_code }}</span>
                                    {% endif %}

                                    {% if product.content.short_description is defined %}
                                        <p class="product-item-description">
                                            {{ product.content.short_description|slice(0, 100) }}...
                                        </p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>

            {# Paginacja #}
            {% if content.products.pages is defined and content.products.pages|length > 0 and content.products.pages|length < content.products.total %}
                <div class="row">
                    <div class="col-md-12 text-center">
                        <div class="pagination-wrap">
                            <nav>
                                <ul class="pagination">
                                    {% if content.products.page > 1 %}
                                        <li>
                                            <a href="?page={{ content.products.page - 1 }}" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                    {% endif %}

                                    {% for i in 1..content.products.pageCount %}
                                        <li class="{{ i == content.products.page ? 'active' : '' }}">
                                            <a href="?page={{ i }}">{{ i }}</a>
                                        </li>
                                    {% endfor %}

                                    {% if content.products.page < content.products.pageCount %}
                                        <li>
                                            <a href="?page={{ content.products.page + 1 }}" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    {% endif %}
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            {% endif %}

        </div>
    </section>

    {# Custom CSS #}
    <style>
        .category-item {
            position: relative;
            overflow: hidden;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .category-item:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }

        .category-item img {
            width: 100%;
            height: auto;
            transition: transform 0.3s ease;
        }

        .category-item:hover img {
            transform: scale(1.05);
        }

        .category-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            padding: 20px;
            color: white;
        }

        .category-overlay h4 {
            margin: 0;
            color: white;
        }

        .category-placeholder {
            width: 100%;
            height: 250px;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .category-placeholder:before {
            content: 'No Image';
            color: #ccc;
            font-size: 18px;
        }

        .product-img-back {
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product-item:hover .product-img-back {
            opacity: 1;
        }

        .product-item-actions {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .product-item:hover .product-item-actions {
            opacity: 1;
        }

        .shop-filter {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .shop-filter .view-mode,
        .shop-filter .filter-by,
        .shop-filter .products-showing {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shop-filter .view-mode a {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 3px;
            color: #666;
            transition: all 0.3s ease;
        }

        .shop-filter .view-mode a:hover,
        .shop-filter .view-mode a.active {
            background: #333;
            border-color: #333;
            color: #fff;
        }

        .shop-filter select {
            height: 35px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .shop-filter {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
{% endblock %}
